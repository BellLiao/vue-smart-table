<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <title>Vue-smart-table by gurghet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <style>
        .smart-table {
            max-width: 600px;
            margin: 20px;
        }
    </style>
</head>
<body>
<div id="app">
    <smart-table
            :auto-load="true"
            body-field="results"
            id-col="id.value"
            endpoint="http://api.randomuser.me/?page=1&results=20"
            :header="[
            {key: 'name.first', label: 'name'},
            {key: 'name.last', label: 'surname'},
            {key: 'gender'},
            {key: 'phone+cell', label: 'contacts'},
            {key: 'picture.thumbnail', label: 'avatar'},
            {key: 'nat', label: 'nationality'}
            ]"
            :order-by="['name.first', 'name.last']"
    >

        <fontawesome slot="gender"></fontawesome>
        <!-- this component is pretty self
             explanatory, it will turn the string
             into the specified icon -->

        <contacts slot="phone+cell"></contacts>
        <!-- phone+cell is a derived column,
             this component is just a <div> tag to
             display 2 lines-->

        <src2img slot="picture.thumbnail"></src2img>
        <!-- this component will read the image
             address inside the nested json
             object and put it into the scr of
             an img tag -->

        <nationality slot="nat"></nationality>
        <!-- this component will take the country
             iso code from the json, query
             a web service and overwrite itself with
             the full country name! -->
    </smart-table>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.24/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/0.8.0/vue-resource.js"></script>
<script src="dist/static/vue-smart-table.js"></script>
<script>
    new Vue({el: '#app'})

    Vue.component('fontawesome', {
        template: ' <i class="fa fa-{{value}}" aria-hidden="true"></i>',
        created () {injectFontAwesome()}
    })

    Vue.component('contacts', {
        template: `
  <div>
    tel. {{value.phone}}<br/>
    cell. {{value.cell}}
  </div>`
    })

    Vue.component('src2img', {
        template: '<img :src="value"></img>'
    })

    Vue.component('nationality', {
        template: `<p>{{value}}</p>`,
        watch: {
            'value' (val) {
                this.$http.get('https://restcountries.eu/rest/v1/alpha/' + val)
                        .then(res => this.$set('value', res.data.name))
            }
        }
    })

    function injectFontAwesome() {
        // avoid duplicates
        for (let i = 0; i < document.styleSheets.length; i++) {
            if (document.styleSheets[i].href === href) {
                return
            }
        }
        let head = document.getElementsByTagName('head')[0]
        let link = document.createElement('link')
        link.rel = 'stylesheet'
        link.type = 'text/css'
        let href = 'https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css'
        link.href = href
        head.appendChild(link)
    }
</script>
</body>
</html>
